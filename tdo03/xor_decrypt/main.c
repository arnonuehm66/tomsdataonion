#include <stdio.h>
#include <stdlib.h>

int g_iKeyLen = 32;
int g_aiKey[] = {
  0x6c, 0x24, 0x84, 0x8e, 0x42, 0x19, 0xa8, 0xe1,
  0xc5, 0xdb, 0x57, 0x65, 0xb9, 0xc6, 0x14, 0x9e,
  0xa5, 0x19, 0x35, 0x96, 0x3b, 0x39, 0x7f, 0xa5,
  0x65, 0xd1, 0xfe, 0x01, 0x85, 0x7d, 0xd9, 0x4c
};


// 0x6c 0x24 0x84 0x8e 0x42 0x19 0xa8 0xe1 0xc5 0xdb 0x57 0x65 0xb9 0xc6 0x14 0x88 0x8f 0x3f 0x62 0xbc 0x27 0x31 0x2d 0x88 0x67 0xc4 0xf1 0x08 0x82 0x3e 0xa4 0x2c
//    =    =    [    .    L    a    y    e    r    .    4    /    6    :    .    ?
// 0x6c 0x24 0x84 0x8e 0x42 0x19 0xa8 0xe1 0xc5 0xdb 0x57 0x65 0xb9 0xc6 0x14 0x9e 0xa5 0x19 0x35 0x96 0x3b 0x39 0x7f 0xa5 0x65 0xd1 0xfe 0x01 0x85 0x7d 0xcb 0x5c
//                                                                               =    =    =    =    =    =    =    =    =    =    =    =    = 0x0a 0x0a    ?    ?

// Possible key is:
// 0x6c 0x24 0x84 0x8e 0x42 0x19 0xa8 0xe1 0xc5 0xdb 0x57 0x65 0xb9 0xc6 0x14 0x9e 0xa5 0x19 0x35 0x96 0x3b 0x39 0x7f 0xa5 0x65 0xd1 0xfe 0x01 0x85 0x7d 0xa4 0x2c

// Results of offsets 62 and 63 are wrong so 30, 31 are wrong!
// 30, 31 are 0x5d and 0x3d "]=", but should be 0x20 and 0x5d " ]"
// Payload at offsets 30, 31 are 0xf9 and 0x11. Xor of should been and payload
// yields 0xd9 and 0x4c!


//******************************************************************************
void theKey(int* paiKey) {
  for (int i = 0; i < g_iKeyLen; ++i) paiKey[i] = g_aiKey[i];
}

//******************************************************************************
void testText(int* paiTxt) {
  //"==[ Layer 4/6: XOR Encryption ]=============================0x0a0x0aEx"
  paiTxt[ 0] = 0x3d; paiTxt[ 1] = 0x3d; paiTxt[ 2] = 0x5b; paiTxt[ 3] = 0x20;
  paiTxt[ 4] = 0x4c; paiTxt[ 5] = 0x61; paiTxt[ 6] = 0x79; paiTxt[ 7] = 0x65;
  paiTxt[ 8] = 0x72; paiTxt[ 9] = 0x20; paiTxt[10] = 0x34; paiTxt[11] = 0x2f;
  paiTxt[12] = 0x36; paiTxt[13] = 0x3a; paiTxt[14] = 0x20; paiTxt[15] = 0x58;
  paiTxt[16] = 0x4f; paiTxt[17] = 0x52; paiTxt[18] = 0x20; paiTxt[19] = 0x45;
  paiTxt[20] = 0x6e; paiTxt[21] = 0x63; paiTxt[22] = 0x72; paiTxt[23] = 0x79;
  paiTxt[24] = 0x70; paiTxt[25] = 0x74; paiTxt[26] = 0x69; paiTxt[27] = 0x6f;
  paiTxt[28] = 0x6e; paiTxt[29] = 0x20; paiTxt[30] = 0x5d; paiTxt[31] = 0x3d;
  paiTxt[32] = 0x3d; paiTxt[33] = 0x3d; paiTxt[34] = 0x3d; paiTxt[35] = 0x3d;
  paiTxt[36] = 0x3d; paiTxt[37] = 0x3d; paiTxt[38] = 0x3d; paiTxt[39] = 0x3d;
  paiTxt[40] = 0x3d; paiTxt[41] = 0x3d; paiTxt[42] = 0x3d; paiTxt[43] = 0x3d;
  paiTxt[44] = 0x3d; paiTxt[45] = 0x3d; paiTxt[46] = 0x3d; paiTxt[47] = 0x3d;
  paiTxt[48] = 0x3d; paiTxt[49] = 0x3d; paiTxt[50] = 0x3d; paiTxt[51] = 0x3d;
  paiTxt[52] = 0x3d; paiTxt[53] = 0x3d; paiTxt[54] = 0x3d; paiTxt[55] = 0x3d;
  paiTxt[56] = 0x3d; paiTxt[57] = 0x3d; paiTxt[58] = 0x3d; paiTxt[59] = 0x3d;
  paiTxt[60] = 0x0a; paiTxt[61] = 0x0a; paiTxt[62] = 0x45; paiTxt[63] = 0x78;
}


//******************************************************************************
int main() {
  int aiKey[32] = {0};
//  int aiPay[64] = {0};
  int c         =  0;
  int k         =  0;

//  testText(aiPay);
  theKey(aiKey);

  while ((c = getchar()) != EOF) {
    //printf("0x%02x ", c);
    c = aiKey[k] ^ c;
    putchar(c);
//    printf("0x%02x\n", aiKey[k]);
    ++k;
    if (k == g_iKeyLen) k = 0;
  }
}
